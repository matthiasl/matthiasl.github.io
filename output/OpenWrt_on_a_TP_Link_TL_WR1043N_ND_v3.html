<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC '-//W3C//DTD XHTML 1.0 Strict//EN'
'http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd'>
<html xmlns='http://www.w3.org/1999/xhtml' xml:lang='en' lang='en'>
<head>
<title>
Matthias' personal blog</title>
<link rel='stylesheet' type='text/css' media='screen' href='./style.css'/>
</head>
<body>
<div id='outer'>
<div id='masthead'>
<a href='index.html'>Matthias' personal blog</a><br/><span id='subtitle'/></div>
<div id='articles'>
<div id='sidebar'>
<div id='about'>
<h3>
ABOUT</h3>

<p>
 This is my personal blog. I also write on the
<a href='https://blog.corelatus.com'>Corelatus blog</a>.
</p>
matthias@corelatus.com
</p>
</div>
<div id='toc'>
<h3>
CATEGORY: All</h3>
<h4>
2017</h4>
<div class='toc_entry'>
<a href='Using__fwknop__on_OpenWRT.html'>Using 'fwknop' on OpenWRT</a></div>
<h4>
2016</h4>
<div class='toc_entry'>
<a href='Watermarking_a_PDF_with_ghostscript.html'>Watermarking a PDF with ghostscript</a></div>
<div class='toc_entry'>
<a href='OpenWrt_on_a_TP_Link_TL_WR1043N_ND_v3.html'>OpenWrt on a TP-Link TL-WR1043N/ND v3</a></div>
<div class='toc_entry'>
<a href='Adjusting_the_external_monitor_backlight.html'>Adjusting the external monitor backlight</a></div>
<div class='toc_entry'>
<a href='Fixing_video_tearing_in_X__and_a_glance_at_Wayland___h2_.html'>Fixing video tearing in X (and a glance at Wayland)</h2></a></div>
<div class='toc_entry'>
<a href='Using_a__bash__function_to_silence_GTK_3_20.html'>Using a 'bash' function to silence GTK 3.20</a></div>
<div class='toc_entry'>
<a href='Having_an_online_resume_without_Linkedin.html'>Having an online resume without Linkedin</a></div>
</div>
<div id='categories'>
<h3>
CATEGORIES</h3>
<p>
<a href='index.html'>All articles(7)</a></p>
<p>
<a href='tagged_with_blog.html'>blog(7)</a></p>
</div>
</div>
<h2>
OpenWrt on a TP-Link TL-WR1043N/ND v3</h2>
<p class='posted'>
<em>Posted December 5th 2016</em></p>
<p>
  Getting this to work was surprisingly rough. I ran into
  trouble with OpenWrt versions, broken old config and
  interface name confusion. But it's nice now that it works.
</p>

<h3>Firmware update</h3>
<p>
  The current (2016-12) stable version of OpenWrt is "Chaos
  Calmber 15.05.1". That version has support for v1 and v2 of
  my access point, but not v3. According to one page I found,
  you can hack (by editing one byte) the v2 image to install
  it on a v3 device, but that seemed too risky. I installed
  a daily snapshot from a few days back instead.
</p>

<p>
  I did the install via the CLI, using 'scp' to copy the file
  to /tmp and 'sysupgrade' to do the install.
</p>

<h3>LUCI</h3>

<p>
  Snapshots don't include LUCI, the browser UI. So I installed
  that with 'opkg update' and 'opkg install luci'.
</p>

<h3>Old/Broken settings</h3>

<p>
  Both before and after upgrading, the wired interfaces on
  the access point worked fine but the wireless was 'disabled'
  no matter what I did. I couldn't figure out what was wrong and
  ended up re-installing the firmware via LUCI and unchecking the
  'retain settings' box. After that, wireless worked.
</p>

<h3>Guest wireless</h3>

<p>
  Mostly for fun, I set up an unencrypted guest network alongside
  my regular network. I did that entirely in LUCI. I put it
  in its own network, 'guest_nw'. To get that talking to the
  outside world, I had to add forwarding to the 'wan'.
</p>

<p>
  I also installed 'SQM QOS', i.e. 'opkg install ...' and
  limited the bandwidth for the guest network. It's a bit
  tricky to figure out which 'interface name' relates to
  which wireless network, in my case it was 'wlan0-1'.
</p>
<div class='article-terminator'><p><a href='OpenWrt_on_a_TP_Link_TL_WR1043N_ND_v3.html'>Permalink</a> | Tags: <a href='tagged_with_blog.html'>blog</a></p></div></div>
</div>
</body>
</html>
